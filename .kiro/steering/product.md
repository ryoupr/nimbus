---
inclusion: always
---

# EC2 Connect v3.0 - プロダクトガイド

AWS EC2 SSM 接続管理 CLI ツール（Rust 実装）

## コア価値

1. **信頼性**: セッション切断を最小化し、自動復旧を提供
2. **軽量性**: リソース消費を抑えたバックグラウンド動作
3. **診断性**: 接続問題の原因特定と解決を支援

## 機能優先度

実装・修正時は以下の優先度に従う：

| 優先度 | 機能カテゴリ | 例 |
|--------|-------------|-----|
| 高 | セッション管理 | 接続、切断検出、再接続 |
| 高 | 診断・修復 | エラー検出、自動修復、提案生成 |
| 中 | パフォーマンス | メトリクス収集、最適化 |
| 中 | UI/UX | ターミナル UI、フィードバック |
| 低 | 統合機能 | VS Code 連携、外部ツール |

## パフォーマンス制約（必須）

新機能・変更時は以下を維持すること：

- メモリ: ≤ 10MB
- CPU（アイドル時）: ≤ 0.5%
- 接続時間: ≤ 150ms
- 切断検出: ≤ 5秒

制約を超える場合は、設計の見直しまたはユーザーへの確認が必要。

## 設計原則

- **非同期優先**: ブロッキング操作を避け、Tokio ランタイムを活用
- **フェイルセーフ**: エラー時は安全な状態にフォールバック
- **段階的劣化**: 一部機能の失敗が全体に波及しない設計
- **ユーザーフィードバック**: 長時間操作には進捗表示を提供

## ユーザーコンテキスト

主要ユーザー：
- AWS EC2 に頻繁に接続する開発者
- 複数インスタンスを管理する DevOps エンジニア
- 本番環境の運用チーム

ユーザーは CLI 操作に慣れており、技術的な詳細を理解できる前提で設計する。
ただし、エラーメッセージと診断結果は具体的なアクションを示すこと。

## 判断基準

機能追加・変更の判断に迷う場合：

1. パフォーマンス制約を満たすか？ → 満たさなければ再設計
2. 既存のセッション管理に影響するか？ → 影響する場合は慎重にテスト
3. エラー時にユーザーが対処可能か？ → 対処方法を提示する設計に
